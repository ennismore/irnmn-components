var g=Object.defineProperty;var v=(h,i,e)=>i in h?g(h,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[i]=e;var m=(h,i,e)=>v(h,typeof i!="symbol"?i+"":i,e);class p extends HTMLElement{static get observedAttributes(){return["title","description","badge-label","images","extras","room-amenities","hotel-amenities","link-360","arrow-svg","labels"]}constructor(){super(),this.uniqueId=`card-${Math.random().toString(36).substr(2,9)}`,this.eventCache=new Map;const i=new URLSearchParams(window.location.search);this.debug=i.get("debugTracking")}get roomCode(){return this.getAttribute("room-code")||""}get title(){return this.getAttribute("title")||""}get description(){return this.getAttribute("description")||""}get images(){try{return JSON.parse(this.getAttribute("images")||"[]")}catch{return[]}}get badgeLabel(){return this.getAttribute("badge-label")||""}get extras(){try{return JSON.parse(this.getAttribute("extras")||"[]")}catch{return[]}}get roomAmenities(){try{return JSON.parse(this.getAttribute("room-amenities")||"[]")}catch{return[]}}get hotelAmenities(){try{return JSON.parse(this.getAttribute("hotel-amenities")||"[]")}catch{return[]}}get link360(){return this.getAttribute("link-360")||""}get labels(){try{return JSON.parse(this.getAttribute("labels")||"{}")}catch{return{}}}get columnLayout(){return this.getAttribute("columns")||"unknown"}get arrowSvg(){return this.getAttribute("arrow-svg")||`
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="32" viewBox="0 0 18 32" fill="none">
            <path d="M1.44922 31L16.4492 16L1.44922 1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        </svg>`}connectedCallback(){this.render(),this.addListeners()}attributeChangedCallback(i,e,t){e!==t&&(this.render(),this.addListeners())}pushTrackingEvent(i,e="roomCard"){const t=this.title,s=this.columnLayout,r=`${i}:${e}:${t}`,n=Date.now();if(!i||!t||!s){this.debug&&console.warn("[RoomCard] Missing data for tracking",{interactionType:i,roomInfo:t,columnLayout:s});return}const l=this.eventCache.get(r);if(l&&n-l<500)return;this.eventCache.set(r,n);const a={event:"room_suite",interactionType:i,elementType:e,columnLayout:s,roomInfo:t};this.debug&&console.debug("[RoomCard] Pushing to dataLayer:",a),window.dataLayer&&Array.isArray(window.dataLayer)?window.dataLayer.push(a):this.debug&&console.warn("[RoomCard] dataLayer not available",a)}addListeners(){const i=this.querySelectorAll(".expand-room-modal");i.forEach(o=>o.addEventListener("click",()=>this.pushTrackingEvent("moreInfo","roomCard"))),this.querySelectorAll(".--book-button").forEach(o=>o.addEventListener("click",()=>this.pushTrackingEvent("book","roomCard"))),this.querySelectorAll(".room-card__slider-prev, .room-card__slider-next").forEach(o=>o.addEventListener("click",()=>this.pushTrackingEvent("carouselClick","roomCard")));const s=this.querySelector(".room-card__slider-360");s&&s.addEventListener("click",()=>this.pushTrackingEvent("360Tour","roomCard"));const r=this.querySelectorAll("irnmn-slider figure"),n=this.querySelector(".room-modal");if(!i.length&&!r.length||!n)return;function l(o,f){let d=!1,c=0,S=0,b=10;o.addEventListener("pointerdown",u=>{d=!1,c=u.clientX,S=u.clientY}),o.addEventListener("pointermove",u=>{(Math.abs(u.clientX-c)>b||Math.abs(u.clientY-S)>b)&&(d=!0)}),o.addEventListener("pointerup",u=>{d||f(u)}),o.addEventListener("dragstart",()=>{d=!0})}function a(o){o.open(),o.querySelectorAll(".--book-button").forEach(d=>{d.removeEventListener("click",d._modalCloseHandler),d._modalCloseHandler=()=>{o.close()},d.addEventListener("click",d._modalCloseHandler)})}i.forEach(o=>{o.addEventListener("click",()=>a(n))}),r.forEach(o=>{l(o,()=>a(n))})}renderSlider(){return`
            <irnmn-slider class="room-card__slider" selectors='{
                "SWIPE_CONTAINER": ".room-card__slider-container",
                "SLIDES": ".room-card__slider-slide",
                "NAVIGATION": ".room-card__slider-navigation",
                "PREV_BUTTON": ".room-card__slider-prev",
                "NEXT_BUTTON": ".room-card__slider-next"
            }'>
                <div class="room-card__slider-container" aria-polite="true" aria-label="${this.labels.slideraria||"Room images"}">
                    ${this.images.map(i=>{if(typeof i=="string")return`<div class="room-card__slider-slide"><figure><img src="${i}" alt="Room image"></figure></div>`;if(i&&typeof i=="object"){const e=i.srcset?` srcset="${i.srcset}"`:"",t=i.sizes?` sizes="${i.sizes}"`:"";return`<div class="room-card__slider-slide"><figure><img src="${i.url}" ${e} ${t} alt="${i.alt||"Room image"}"></figure></div>`}return""}).join("")}
                </div>
                <div class="room-card__slider-navigation">
                    <button class="room-card__slider-prev" aria-label="${this.labels.prevSlide||"See previous image"}">
                        ${this.arrowSvg}
                    </button>
                    <button class="room-card__slider-next" aria-label="${this.labels.nextSlide||"See next image"}">
                        ${this.arrowSvg}
                    </button>
                </div>
                ${this.images.length>1?`
                    <div class="room-card__slider-indicators" aria-hidden="true">
                        <ul aria-hidden="true">
                            <li></li>
                            <li></li>
                            <li></li>
                            <li></li>
                            <li></li>
                            <li></li>
                            <li></li>
                        </ul>
                    </div> `:""}
                ${this.link360?`
                    <a href="${this.link360}" target="_blank" class="room-card__slider-360" aria-label="${this.labels.view360||"View 360 tour"}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16" fill="none">
                        <path d="M10.9016 6.58242V2.85742C10.9016 2.45742 10.6766 2.10742 10.3266 1.95742L7.42656 0.607422C7.15156 0.482422 6.85156 0.482422 6.57656 0.607422L3.67656 1.95742C3.32656 2.13242 3.10156 2.48242 3.10156 2.85742V6.58242C3.10156 6.93242 3.30156 7.28242 3.60156 7.45742L6.50156 9.13242C6.65156 9.23242 6.82656 9.25742 7.00156 9.25742C7.17656 9.25742 7.35156 9.20742 7.50156 9.13242L10.4016 7.45742C10.7266 7.28242 10.9016 6.95742 10.9016 6.58242ZM6.80156 1.05742C6.85156 1.03242 6.92656 1.00742 7.00156 1.00742C7.07656 1.00742 7.15156 1.03242 7.20156 1.05742L10.0766 2.38242L7.00156 3.80742L3.92656 2.38242L6.80156 1.05742ZM3.85156 7.03242C3.70156 6.93242 3.60156 6.78242 3.60156 6.60742V2.85742C3.60156 2.83242 3.60156 2.80742 3.60156 2.78242L6.75156 4.23242V8.68242L3.85156 7.03242ZM10.1516 7.03242L7.25156 8.70742V4.23242L10.4016 2.78242C10.4016 2.80742 10.4016 2.83242 10.4016 2.85742V6.58242C10.4016 6.75742 10.3266 6.93242 10.1516 7.03242Z" fill="white" style="fill:white;fill-opacity:1;"/>
                        <path d="M5.72578 14.3074C5.85078 14.3074 5.97578 14.2074 5.97578 14.0574C5.97578 13.9074 5.87578 13.8074 5.72578 13.8074C2.67578 13.6574 0.800781 12.8574 0.800781 12.1574C0.800781 11.7074 1.77578 11.0324 3.92578 10.7074C4.05078 10.6824 4.15078 10.5574 4.12578 10.4324C4.10078 10.3074 3.97578 10.2074 3.85078 10.2324C1.62578 10.5824 0.300781 11.3074 0.300781 12.1824C0.300781 13.4574 3.10078 14.1824 5.72578 14.3074Z" fill="white" style="fill:white;fill-opacity:1;"/>
                        <path d="M10.6017 10.2822C10.4767 10.2572 10.3267 10.3572 10.3017 10.4822C10.2767 10.6072 10.3767 10.7572 10.5017 10.7822C12.3767 11.1322 13.2017 11.7322 13.2017 12.1572C13.2017 12.7322 11.7767 13.4822 9.12666 13.7322C9.00166 13.7572 8.87666 13.8572 8.90166 14.0072C8.90166 14.1322 9.02666 14.2322 9.15166 14.2322H9.17666C11.2767 14.0322 13.7017 13.3572 13.7017 12.1572C13.7017 11.3572 12.5767 10.6822 10.6017 10.2822Z" fill="white" style="fill:white;fill-opacity:1;"/>
                        <path d="M5.60078 12.6072C5.50078 12.5322 5.35078 12.5322 5.25078 12.6322C5.15078 12.7322 5.17578 12.8822 5.27578 12.9822L6.40078 13.9572L5.25078 15.1322C5.15078 15.2322 5.15078 15.3822 5.25078 15.4822C5.30078 15.5322 5.37578 15.5572 5.42578 15.5572C5.47578 15.5572 5.55078 15.5322 5.60078 15.4822L6.95078 14.1322C7.00078 14.0822 7.02578 14.0072 7.02578 13.9572C7.02578 13.9072 7.00078 13.8322 6.95078 13.7822L5.60078 12.6072Z" fill="white" style="fill:white;fill-opacity:1;"/>
                        </svg>
                        ${this.labels.view360||"360 tour"}
                    </a>
                `:""}
                ${this.badgeLabel?`<span class="room-card__badge">${this.badgeLabel}</span>`:""}
            </irnmn-slider> `}renderPricing(){return`
        <div class="room-card__pricing">
            <button class="room-card__pricing-cta btn --book-button" aria-label="${this.labels.book?`${this.labels.book} ${this.title}`:`Book ${this.title}`}">${this.labels.book||"BOOK"}</button>
        </div>
        `}renderExtras(i=!0){return`
            <div class="room-card__extras">
                <p class="room-card__extras__list" role="list">
                    ${this.extras.map(e=>`<span role="listitem">${e}</span>`).join("")}
                </p>
                ${i?`<button aria-label="${this.labels.more?`${this.title} ${this.labels.more}`:`${this.title} More info`}" class="btn btn-secondary expand-room-modal">${this.labels.more||"More info"}</button>`:""}
            </div>
        `}renderAmenities(i,e,t){return!Array.isArray(i)||i.length===0?"":`
            <div class="room-card__amenities ${t}">
                <h4 class="room-card__amenities-title">${e}</h4>
                <ul class="room-card__amenities-list">
                    ${i.map(s=>`<li class="amenity">${s}</li>`).join("")}
                </ul>
            </div>
        `}render(){const i=this.renderSlider(),e=this.renderPricing(),t=this.renderAmenities(this.roomAmenities,this.labels.roomAmenities||"Room Amenities","--room-amenities"),s=this.renderAmenities(this.hotelAmenities,this.labels.hotelAmenities||"Hotel Amenities","--hotel-amenities");this.innerHTML=`
            <div class="room-card">
                ${i}
                <div class="room-card__content">
                    <h2 class="room-card__title">${this.title}</h2>
                    ${this.renderExtras(!0)}
                    ${e}
                    <p class="room-card__description">${this.description}</p>
                </div>
            </div>

            <irnmn-modal class="room-modal" modal-content="template" modal-close="${this.labels.close||"Close"}" labelledby="room-modal-title__${this.uniqueId}">
                <template>
                    <div class="room-modal__inner">
                        ${i}
                        <div class="room-card__content">
                            <div class="room-modal__header">
                                <h2 class="room-card__title" id="room-modal-title__${this.uniqueId}">${this.title}</h2>
                                ${e}
                            </div>
                            ${this.renderExtras(!1)}
                            <p class="room-card__description">${this.description}</p>
                            ${e}
                            ${t}
                            ${s}
                        </div>
                    </div>
                </template>
            </irnmn-modal>
        `}}customElements.get("irnmn-room-card")||customElements.define("irnmn-room-card",p);class L extends HTMLElement{constructor(){super();m(this,"CLASSNAMES",[]);m(this,"eventListeners",[]);m(this,"slides",[]);m(this,"slideOffsets",[]);m(this,"currentSlide",1);this.CLASSNAMES=this.selectors;const e=new URLSearchParams(window.location.search);this.debug=e.get("debugTracking"),this.debug&&console.info("[IRNMNSlider] Constructor called, CLASSNAMES:",this.CLASSNAMES)}get selectors(){let e=this.getAttribute("selectors"),t=[];try{e=JSON.parse(e)}catch(s){console.error("Error parsing selectors:",s)}for(let s in e)t[s.toUpperCase()]=e[s];return t}get transition(){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return"0.001s ease";const t=this.getAttribute("transition");return typeof t=="string"&&t.trim()?t:"0.3s ease"}connectedCallback(){new IntersectionObserver(([t],s)=>{t.isIntersecting&&(this.debug&&console.info("[IRNMNSlider] Element is visible, initializing slider..."),this.initSlider(),s.disconnect())},{root:null,threshold:0}).observe(this),this.debug&&console.info("[IRNMNSlider] IntersectionObserver set up."),this.ariaLiveRegion=document.createElement("div"),this.ariaLiveRegion.setAttribute("aria-live","polite"),this.ariaLiveRegion.setAttribute("aria-atomic","true"),this.ariaLiveRegion.classList.add("visually-hidden"),Object.assign(this.ariaLiveRegion.style,{position:"absolute",height:"1px",width:"1px",overflow:"hidden",clip:"rect(1px, 1px, 1px, 1px)",whiteSpace:"nowrap"}),this.appendChild(this.ariaLiveRegion)}disconnectedCallback(){this.eventListeners.forEach(({element:e,event:t,handler:s})=>{e.removeEventListener(t,s)}),this.eventListeners=[],this.debug&&console.info("[IRNMNSlider] Event listeners cleaned up.")}initSlider(){const e=this.querySelector(this.CLASSNAMES.SWIPE_CONTAINER);if(!e){console.error("Swipe container not found");return}e.id||(e.id=`slider-container-${Math.floor(Math.random()*1e6)}`),this.setupResizeListener(e),this.slides=Array.from(e.querySelectorAll(this.CLASSNAMES.SLIDES)),e.setAttribute("role","region"),!e.hasAttribute("aria-label")&&!e.hasAttribute("aria-labelledby")&&e.setAttribute("aria-label","Slideshow with multiple slides"),e.setAttribute("tabindex","0"),e.setAttribute("aria-roledescription","carousel");const t=this.querySelector(this.CLASSNAMES.PREV_BUTTON),s=this.querySelector(this.CLASSNAMES.NEXT_BUTTON);t&&!t.hasAttribute("aria-label")&&(t.setAttribute("aria-label","Previous slide"),t.setAttribute("aria-controls",e.id)),s&&!s.hasAttribute("aria-label")&&(s.setAttribute("aria-label","Next slide"),s.setAttribute("aria-controls",e.id));const r=this.slides.length;if(r===1){this.debug&&console.info("[IRNMNSlider] Only one slide detected, rendering single slide."),this.renderSingleSlide(this.slides[0]);return}if(this.dataset.sliderInitialized==="true"){this.debug&&console.info("[IRNMNSlider] Slider already initialized, skipping.");return}this.dataset.sliderInitialized="true",this.cloneSlides(e),this.calculateSlideOffsets(e),this.updateTotalSlides(r),this.initializePosition(e),this.addEventListeners(e,r),this.initSlidesAttributes(),this.updateSlidesAttributes(1),this.debug&&console.info("[IRNMNSlider] Slider initialization complete.")}setupResizeListener(e){let t;const s=()=>{clearTimeout(t),t=setTimeout(()=>{e&&(this.calculateSlideOffsets(e),this.centerSlide(e),this.debug&&console.info("[IRNMNSlider] Window resized, recalculated offsets and centered slide."))},150)};window.addEventListener("resize",s),this.eventListeners.push({element:window,event:"resize",handler:s})}renderSingleSlide(e){var t,s,r;e.style.cssText="display: block; margin: 0 auto;",(t=this.querySelector(this.CLASSNAMES.PREV_BUTTON))==null||t.remove(),(s=this.querySelector(this.CLASSNAMES.NEXT_BUTTON))==null||s.remove(),(r=this.querySelector(this.CLASSNAMES.CONTROLS))==null||r.remove(),this.debug&&console.info("[IRNMNSlider] Navigation and controls removed for single slide.")}cloneSlides(e){e.querySelectorAll(".clone-slide").forEach(r=>r.remove());const t=this.slides[0],s=this.slides[this.slides.length-1];if(t&&s){const r=t.cloneNode(!0),n=s.cloneNode(!0);r.dataset.clone="true",n.dataset.clone="true",r.classList.add("clone-slide"),n.classList.add("clone-slide"),e.appendChild(r),e.insertBefore(n,t)}this.slides=Array.from(e.querySelectorAll(this.CLASSNAMES.SLIDES)),this.debug&&console.info("[IRNMNSlider] Slides cloned for infinite loop. Total slides (with clones):",this.slides.length)}calculateSlideOffsets(){this.slideOffsets=[0];let e=0;this.slides.forEach(t=>{e+=t.offsetWidth,this.slideOffsets.push(e)}),this.debug&&console.info("[IRNMNSlider] Slide offsets calculated:",this.slideOffsets)}updateTotalSlides(e){const t=this.querySelector(this.CLASSNAMES.TOTAL_SLIDES);t&&(t.textContent=e),this.debug&&console.info("[IRNMNSlider] Total slides updated:",e)}initializePosition(e){this.currentSlide=1,e.style.transition="none",this.centerSlide(e),this.debug&&console.info("[IRNMNSlider] Slider position initialized to slide:",this.currentSlide)}addEventListeners(e,t){const s=this.slides.length,r=()=>this.updateSlides(e,s,t),n=()=>this.resetPosition(e,s,t),l=()=>this.moveToNextSlide(r,s),a=()=>this.moveToPrevSlide(r,s);this.setupDragAndDrop(e,l,a,r),this.addListener(this.querySelector(this.CLASSNAMES.PREV_BUTTON),"click",a),this.addListener(this.querySelector(this.CLASSNAMES.NEXT_BUTTON),"click",l),this.addListener(e,"transitionend",n),this.addListener(e,"keydown",o=>{if(!(!this.dataset.sliderInitialized||!this.contains(document.activeElement)))switch(o.key){case"ArrowRight":case"Right":o.preventDefault(),l();break;case"ArrowLeft":case"Left":o.preventDefault(),a();break;case"Home":o.preventDefault(),this.currentSlide=1,r();break;case"End":o.preventDefault(),this.currentSlide=t,r();break}}),this.debug&&console.info("[IRNMNSlider] Navigation, drag and keyboard event listeners added.")}addListener(e,t,s){e&&(e.addEventListener(t,s),this.eventListeners.push({element:e,event:t,handler:s}))}centerSlide(e){const t=this.slideOffsets[this.currentSlide],s=this.slides[this.currentSlide].offsetWidth;e.style.transform=`translateX(calc(-${t}px + 50% - ${s/2}px))`,this.debug&&console.info("[IRNMNSlider] Centered slide:",this.currentSlide,"Offset:",t,"Width:",s)}initSlidesAttributes(){const e=this.querySelectorAll(`${this.CLASSNAMES.SLIDES}:not([data-clone])`).length;this.slides.forEach((t,s)=>{t.dataset.clone==="true"?(t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),t.removeAttribute("role"),t.removeAttribute("aria-roledescription"),t.removeAttribute("aria-label")):(t.setAttribute("role","group"),t.setAttribute("aria-roledescription","slide"),t.hasAttribute("aria-label")||t.setAttribute("aria-label",`Slide ${s} of ${e}`))})}updateSlidesAttributes(e){this.slides.forEach((t,s)=>{if(t.dataset.clone==="true")return;const n=s===e;t.setAttribute("tabindex",n?"0":"-1"),t.classList.toggle("active-slide",n)})}updateSlides(e,t,s){e.style.transition=this.transition,this.centerSlide(e);let r;switch(this.currentSlide){case 0:r=s;break;case t-1:r=1;break;default:r=this.currentSlide;break}this.updateSlidesAttributes(r);const n=this.querySelector(this.CLASSNAMES.CURRENT_SLIDE);if(n&&(n.textContent=r),this.ariaLiveRegion){const a=`Slide ${r} of ${s}`;this.ariaLiveRegion.textContent=a}const l=new CustomEvent("slideChange",{detail:{currentSlideIndex:this.currentSlide,currentSlideDisplayedIndex:r,currentSlideElement:this.slides[this.currentSlide],totalSlides:s,clonedSlidesCount:t}});e.dispatchEvent(l),this.debug&&console.info("[IRNMNSlider] Slide updated:",{currentSlide:this.currentSlide,displayedSlideIndex:r,totalSlides:s,clonedSlidesCount:t})}resetPosition(e,t,s){this.currentSlide===0?this.currentSlide=s:this.currentSlide===t-1&&(this.currentSlide=1),e.style.transition="none",this.centerSlide(e),this.classList.remove("transitioning-prev"),this.classList.remove("transitioning-next");const r=document.activeElement;if(r&&this.slides.some(n=>n===r||n.contains(r))){const n=this.slides[this.currentSlide];n&&n.focus()}this.debug&&console.info("[IRNMNSlider] Position reset after transition. Current slide:",this.currentSlide)}moveToNextSlide(e,t){this.classList.contains("transitioning-next")||this.classList.contains("transitioning-prev")||(this.classList.add("transitioning-next"),this.currentSlide=(this.currentSlide+1)%t,e(),this.debug&&console.info("[IRNMNSlider] Moved to next slide:",this.currentSlide))}moveToPrevSlide(e,t){this.classList.contains("transitioning-next")||this.classList.contains("transitioning-prev")||(this.classList.add("transitioning-prev"),this.currentSlide=(this.currentSlide-1+t)%t,e(),this.debug&&console.info("[IRNMNSlider] Moved to previous slide:",this.currentSlide))}setupDragAndDrop(e,t,s,r){let n=0,l=0,a=!1;const o=c=>{n=c.touches?c.touches[0].clientX:c.clientX,a=!0,e.style.transition="none",this.debug&&console.info("[IRNMNSlider] Drag/touch start:",n)},f=c=>{if(!a)return;l=(c.touches?c.touches[0].clientX:c.clientX)-n;const S=this.slideOffsets[this.currentSlide],b=this.slides[this.currentSlide].offsetWidth;e.style.transform=`translateX(calc(-${S}px + 50% - ${b/2}px + ${l}px))`,this.debug&&console.info("[IRNMNSlider] Drag/touch move:",l)},d=()=>{a&&(e.style.transition=this.transition,l>50?s():l<-50?t():r(),l=0,a=!1,this.debug&&console.info("[IRNMNSlider] Drag/touch end."))};this.addListener(e,"touchstart",o),this.addListener(e,"touchmove",f),this.addListener(e,"touchend",d),this.addListener(e,"mousedown",o),this.addListener(e,"mousemove",f),this.addListener(e,"mouseup",d),this.addListener(e,"mouseleave",d),this.debug&&console.info("[IRNMNSlider] Drag and drop/touch listeners set up.")}refresh(){const e=this.querySelector(this.CLASSNAMES.SWIPE_CONTAINER);if(!e){console.error("Swipe container not found");return}this.calculateSlideOffsets(e),this.centerSlide(e),this.debug&&console.info("[IRNMNSlider] Slider refreshed.")}}customElements.get("irnmn-slider")||customElements.define("irnmn-slider",L);class A extends HTMLElement{constructor(){super(),this.lastFocusedElement=null,this.content=null,this.styles=null}get sessionKey(){return this.getAttribute("session-key")||null}get initShow(){return this.hasAttribute("init-show")&&this.getAttribute("init-show")==="true"}get closeLabel(){return this.getAttribute("modal-close")||"Close"}get modalEndpoint(){return this.getAttribute("modal-endpoint")}get modalContentType(){return this.getAttribute("modal-content")||"endpoint"}get labelledby(){return this.getAttribute("labelledby")||""}async connectedCallback(){await this.renderPopup()}static get observedAttributes(){return["modal-endpoint","modal-content"]}async attributeChangedCallback(i,e,t){e!==t&&await this.renderPopup()}async renderPopup(){if(!(this.sessionKey&&sessionStorage.getItem(this.sessionKey))&&(this.content=await this.getContent(),this.render(),this.attachEventListeners(),await this.loadAssets(),this.dispatchEvent(new CustomEvent("irnmn-modal-loaded",{detail:{element:this}})),!!this.initShow)){if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",()=>this.showModal());return}await this.showModal()}}async getContent(){return this.modalContentType==="template"?this.getTemplateContent():await this.getEndpointContent()}getTemplateContent(){const i=this.querySelector("template");return i?i.innerHTML:(console.warn("No <template> found inside <irnmn-modal>."),"")}async getEndpointContent(){var i,e;if(!this.modalEndpoint)return console.warn("Modal endpoint is not set. Please provide a valid endpoint."),"";try{const t=await fetch(this.modalEndpoint);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();return this.styles=((i=s.blockAssets)==null?void 0:i.styles)||[],((e=s.content)==null?void 0:e.rendered)||""}catch(t){return console.error("Error fetching modal content:",t),""}}render(){this.innerHTML=`
            <dialog class="irnmn-modal" role="dialog" aria-modal="true" aria-hidden="true" tabindex="-1" aria-labelledby="${this.labelledby}">
                <div class="irnmn-modal__container">
                    <button class="irnmn-modal__close" aria-label="${this.closeLabel}">${this.closeLabel}</button>
                    ${this.content}
                </div>
            </dialog>
        `}async loadAssets(){this.styles&&this.styles.length&&this.styles.forEach(i=>{if(!document.querySelector(`link[href="${i}"]`)){const e=document.createElement("link");e.rel="stylesheet",e.href=i,document.head.appendChild(e)}})}attachEventListeners(){const i=this.querySelector(".irnmn-modal"),e=this.querySelector(".irnmn-modal__close");e&&e.addEventListener("click",t=>{t.preventDefault(),this.closeModal()}),i.addEventListener("keydown",t=>{t.key==="Escape"?(t.preventDefault(),this.closeModal()):t.key==="Tab"&&this.trapFocus(t,i)}),i.addEventListener("click",t=>{t.target===i&&this.closeModal()}),this.querySelectorAll("[data-close]").forEach(t=>{t.addEventListener("click",s=>{s.preventDefault(),this.closeModal()})})}async showModal(){const i=this.querySelector(".irnmn-modal");if(!i)return;this.lastFocusedElement=document.activeElement;const e=()=>{i.showModal(),i.classList.add("irnmn-modal--visible"),i.setAttribute("aria-hidden","false"),i.focus(),document.body.classList.add("irnmn-modal-open")};document.startViewTransition?await document.startViewTransition(()=>{e()}):e(),this.dispatchEvent(new CustomEvent("irnmn-modal-opened",{detail:{element:this}}))}closeModal(){const i=this.querySelector(".irnmn-modal");if(!i)return;const e=()=>{i.close(),i.classList.remove("irnmn-modal--visible"),i.setAttribute("aria-hidden","true"),this.sessionKey&&sessionStorage.setItem(this.sessionKey,"shown"),this.lastFocusedElement&&this.lastFocusedElement.focus(),document.body.classList.remove("irnmn-modal-open")};document.startViewTransition?document.startViewTransition(()=>{e()}):e(),this.dispatchEvent(new CustomEvent("irnmn-modal-closed",{detail:{element:this}}))}trapFocus(i,e){if(i.key!=="Tab")return;const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(t.length===0)return;const s=t[0],r=t[t.length-1];i.shiftKey&&document.activeElement===s?(i.preventDefault(),r.focus()):!i.shiftKey&&document.activeElement===r&&(i.preventDefault(),s.focus())}open(){return this.showModal()}close(){return this.closeModal()}}customElements.get("irnmn-modal")||customElements.define("irnmn-modal",A);
